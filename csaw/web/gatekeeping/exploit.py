#!/bin/python3
import sys
import binascii
from Crypto.Cipher import AES

key = 'b5082f02fd0b6a06203e0a9ffb8d7613dd7639a67302fc1f357990c49a6541f3'
path = 'flag.txt.enc'

def decrypt(path, key):
    data = b''
    with open(path, 'rb') as f:
        data = f.read()
    data = data[16:]
    key = binascii.unhexlify(key)
    iv = data[:AES.block_size]
    data = data[AES.block_size:]
    cipher = AES.new(key, AES.MODE_CFB, iv)
    return cipher.decrypt(data)

if __name__=="__main__":
    if len(sys.argv) > 2:
        path, key = sys.argv[1], sys.argv[2]
    result = decrypt(path, key)
    print(result)
